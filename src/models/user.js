const mongoose = require("mongoose");
const bcrypt = require("bcryptjs");
const jwt = require("jsonwebtoken");
const { response } = require("express");

//registration form schema
const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true,
  },
  email: {
    type: String,
    required: true,
    unique: true,
  },
  username: {
    type: String,
    default: "",
  },
  ph_no: {
    type: String,
    default: "",
  },
  password: {
    type: String,
    required: true,
  },
  dateCreated: {
    type: String,
    required: true,
    default: Date.now(),
  },
  profile_img: {
    type: String,
    default:
      "data:image/jpeg;base64,/9j/4QCORXhpZgAATU0AKgAAAAgABQEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAIKYAAIAAAArAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABKGMpIE1vaGFtbWFkIFN1bGhhbiBCYWRyaSB8IERyZWFtc3RpbWUuY29tAAD/7QBSUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAADYcAnQAKihjKSBNb2hhbW1hZCBTdWxoYW4gQmFkcmkgfCBEcmVhbXN0aW1lLmNvbRwCAAACAAT/4Qx1aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pgo8eDp4bXBtZXRhIHhtbG5zOng9J2Fkb2JlOm5zOm1ldGEvJyB4OnhtcHRrPSdJbWFnZTo6RXhpZlRvb2wgMTAuODAnPgo8cmRmOlJERiB4bWxuczpyZGY9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMnPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6cGx1cz0naHR0cDovL25zLnVzZXBsdXMub3JnL2xkZi94bXAvMS4wLyc+CiAgPHBsdXM6TGljZW5zb3I+CiAgIDxyZGY6U2VxPgogICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSdSZXNvdXJjZSc+CiAgICAgPHBsdXM6TGljZW5zb3JVUkw+aHR0cHM6Ly93d3cuZHJlYW1zdGltZS5jb208L3BsdXM6TGljZW5zb3JVUkw+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvcGx1czpMaWNlbnNvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wUmlnaHRzPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyc+CiAgPHhtcFJpZ2h0czpXZWJTdGF0ZW1lbnQ+aHR0cHM6Ly93d3cuZHJlYW1zdGltZS5jb20vYWJvdXQtc3RvY2staW1hZ2UtbGljZW5zZXM8L3htcFJpZ2h0czpXZWJTdGF0ZW1lbnQ+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0ndyc/Pv/bAEMACAYGBwYFCAcHBwkJCAoMFA0MCwsMGRITDxQdGh8eHRocHCAkLicgIiwjHBwoNyksMDE0NDQfJzk9ODI8LjM0Mv/CAAsIAyADIAEBIgD/xAAaAAEAAgMBAAAAAAAAAAAAAAAAAQUCAwQG/9oACAEBAAAAAffgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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A1kKAHopnSxo2PSz0gwTFvT05N42Tk9b0xMP+Nr/2gAIAQEAAAAQ/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AOZ//wD/AP8A/wD/AP8A/wD/AP8A/wDV+r//AP8A/wD/AP8A/wD/AP8A/wDX/wD+v/8A/wD/AP8A/wD/AP8A/wDv/wD/AP8Af/8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/v8A/wD/AP8A9/8A/wD/AP8A/wD/AP8An/8A/wD/AP8An/8A/wD/AP8A/wD/APP/AP8A/wD/APz/AP8A/wD/AP8A/wD8/wD/AP8A/wD/APP/AP8A/wD/AP8A/wCf/wD/AP8A/wD/AJ//AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wB//wD/AP8A/wD/AO//AP8A/wD/AP8A7/8A/wD/AP8A/wD/AH//AP8A/wD/AP3/AP8A/wD/AP8A/wD7/wD/AP8A/wD/AD//AP8A/wD/AP8A/wDP/wD/AP8A/wDn/wD/AP8A/wD/AP8A/n//AP8A/wD+/wD/AP8A/wD/AP8A/wD3/wD/AP8A/wDf/wD/AP8A/wD/AP8A/wC//wD/AP8A+f8A/wD/AP8A/wD/AP8A+f8A/wD/AP8Av/8A/wD/AP8A/wD/AP8A3/8A/wD/APf/AP8A/wD/AP8A/wD/AP7/AP8A/wD/AP8A/wD/APoF/wD/AP8A/wD/AP8A/wD/AP8A/wD/AAAP/wD/AP8A/wD/AP8A/wD/AP8A/wCAAB//AP8A/wD/AP8A/wDf/wD/APwAA/8A/wD/AP8A/wD/AP8A/wD/AP4AAAf/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",
  },
});

//generating token on register
userSchema.methods.generateAuthToken = async function () {
  try {
    const token = jwt.sign(
      { _id: this._id.toString() },
      process.env.SECRET_KEY
    );
    return token;
  } catch (error) {
    response.send(error);
  }
};

//hashing
userSchema.pre("save", async function (next) {
  if (this.isModified("password")) {
    this.password = await bcrypt.hash(this.password, 10);
  }

  next();
});

//creating a collection

const User = new mongoose.model("User", userSchema);

module.exports = User;
